<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Solvers · ProbNumDiffEq.jl</title><meta name="title" content="Solvers · ProbNumDiffEq.jl"/><meta property="og:title" content="Solvers · ProbNumDiffEq.jl"/><meta property="twitter:title" content="Solvers · ProbNumDiffEq.jl"/><meta name="description" content="Documentation for ProbNumDiffEq.jl."/><meta property="og:description" content="Documentation for ProbNumDiffEq.jl."/><meta property="twitter:description" content="Documentation for ProbNumDiffEq.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ProbNumDiffEq.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/getting_started/">Getting Started</a></li><li><a class="tocitem" href="../tutorials/dynamical_odes/">Second Order ODEs and Energy Preservation</a></li><li><a class="tocitem" href="../tutorials/dae/">Differential Algebraic Equations</a></li><li><a class="tocitem" href="../tutorials/exponential_integrators/">Probabilistic Exponential Integrators</a></li><li><a class="tocitem" href="../tutorials/ode_parameter_inference/">Parameter Inference</a></li></ul></li><li><span class="tocitem">Solvers and Options</span><ul><li class="is-active"><a class="tocitem" href>Solvers</a><ul class="internal"><li><a class="tocitem" href="#API"><span>API</span></a></li><li><a class="tocitem" href="#solversrefs"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../priors/">Priors</a></li><li><a class="tocitem" href="../initialization/">Initialization</a></li><li><a class="tocitem" href="../diffusions/">Diffusion models and calibration</a></li></ul></li><li><a class="tocitem" href="../likelihoods/">Data Likelihoods</a></li><li><span class="tocitem">Benchmarks</span><ul><li><a class="tocitem" href="../benchmarks/multi-language-wrappers/">Multi-Language Wrapper Benchmark</a></li><li><input class="collapse-toggle" id="menuitem-5-2" type="checkbox"/><label class="tocitem" for="menuitem-5-2"><span class="docs-label">Non-stiff ODEs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../benchmarks/lotkavolterra/">Lotka-Volterra</a></li><li><a class="tocitem" href="../benchmarks/hodgkinhuxley/">Hodgkin-Huxley</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-3" type="checkbox"/><label class="tocitem" for="menuitem-5-3"><span class="docs-label">Stiff ODEs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../benchmarks/vanderpol/">Van der Pol</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-4" type="checkbox"/><label class="tocitem" for="menuitem-5-4"><span class="docs-label">Second-order ODEs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../benchmarks/pleiades/">Pleiades</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-5" type="checkbox"/><label class="tocitem" for="menuitem-5-5"><span class="docs-label">Differential-Algebraic Equations (DAEs)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../benchmarks/orego/">OREGO</a></li><li><a class="tocitem" href="../benchmarks/rober/">ROBER</a></li></ul></li></ul></li><li><span class="tocitem">Internals</span><ul><li><a class="tocitem" href="../filtering/">Filtering and Smoothing</a></li><li><a class="tocitem" href="../implementation/">Implementation via OrdinaryDiffEq.jl</a></li></ul></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Solvers and Options</a></li><li class="is-active"><a href>Solvers</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Solvers</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/nathanaelbosch/ProbNumDiffEq.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/nathanaelbosch/ProbNumDiffEq.jl/blob/main/docs/src/solvers.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Solvers"><a class="docs-heading-anchor" href="#Solvers">Solvers</a><a id="Solvers-1"></a><a class="docs-heading-anchor-permalink" href="#Solvers" title="Permalink"></a></h1><p>ProbNumDiffEq.jl provides two solvers: the <a href="#ProbNumDiffEq.EK1"><code>EK1</code></a> and the <a href="#ProbNumDiffEq.EK0"><code>EK0</code></a>. Both based on extended Kalman filtering and smoothing, but the latter relies on evaluating the Jacobian of the vector field.</p><p><strong>Which solver should I use?</strong></p><ul><li>Use the <a href="#ProbNumDiffEq.EK1"><code>EK1</code></a> to get the best uncertainty quantification and to solve stiff problems.</li><li>Use the <a href="#ProbNumDiffEq.EK0"><code>EK0</code></a> to get the fastest runtimes and to solve high-dimensional problems.</li></ul><p>All solvers are compatible with DAEs in mass-matrix ODE form. They also specialize on second-order ODEs: If the problem is of type <a href="https://docs.sciml.ai/DiffEqDocs/stable/types/dynamical_types/#SciMLBase.SecondOrderODEProblem"><code>SecondOrderODEProblem</code></a>, it solves the second-order problem directly; this is more efficient than solving the transformed first-order problem and provides more meaningful posteriors <a href="#solversrefs">[1]</a>.</p><h2 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProbNumDiffEq.EK1" href="#ProbNumDiffEq.EK1"><code>ProbNumDiffEq.EK1</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">EK1(; order=3,
      smooth=true,
      prior=IWP(order),
      diffusionmodel=DynamicDiffusion(),
      initialization=TaylorModeInit(num_derivatives(prior)),
      kwargs...)</code></pre><p><strong>Gaussian ODE filter with first-order vector field linearization.</strong></p><p>This is a <em>semi-implicit</em>, L-stable ODE solver so it can handle stiffness quite well [<a href="../references/#tronarp18probsol">4</a>], and it generally produces more expressive posterior covariances than the <a href="#ProbNumDiffEq.EK0"><code>EK0</code></a>. However, as typical implicit ODE solvers it scales cubically with the ODE dimension [<a href="../references/#krämer21highdim">5</a>], so if you&#39;re solving a high-dimensional non-stiff problem you might want to give the <a href="#ProbNumDiffEq.EK0"><code>EK0</code></a> a try.</p><p><strong>Arguments</strong></p><ul><li><code>order::Integer</code>: Order of the integrated Wiener process (IWP) prior.</li><li><code>smooth::Bool</code>: Turn smoothing on/off; smoothing is required for dense output.</li><li><code>prior::AbstractGaussMarkovProcess</code>: Prior to be used by the ODE filter.  By default, uses a 3-times integrated Wiener process prior <code>IWP(3)</code>.  See also: <a href="../priors/#Priors">Priors</a>.</li><li><code>diffusionmodel::ProbNumDiffEq.AbstractDiffusion</code>: See <a href="../diffusions/#Diffusion-models-and-calibration">Diffusion models and calibration</a>.</li><li><code>initialization::ProbNumDiffEq.InitializationScheme</code>: See <a href="../initialization/#Initialization">Initialization</a>.</li></ul><p>Some additional <code>kwargs</code> relating to implicit solvers are supported; check out DifferentialEquations.jl&#39;s <a href="https://diffeq.sciml.ai/stable/solvers/ode_solve/#Extra-Options">Extra Options</a> page. Right now, we support <code>autodiff</code>, <code>chunk_size</code>, and <code>diff_type</code>. In particular, <code>autodiff=false</code> can come in handy to use finite differences instead of ForwardDiff.jl to compute Jacobians.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; solve(prob, EK1())</code></pre><p><strong><a href="../references/#references">References</a></strong></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nathanaelbosch/ProbNumDiffEq.jl/blob/2ab532b621e01503070b9b92aebcb58b9851d7fd/src/algorithms.jl#L141-L177">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProbNumDiffEq.EK0" href="#ProbNumDiffEq.EK0"><code>ProbNumDiffEq.EK0</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">EK0(; order=3,
      smooth=true,
      prior=IWP(order),
      diffusionmodel=DynamicDiffusion(),
      initialization=TaylorModeInit(num_derivatives(prior)))</code></pre><p><strong>Gaussian ODE filter with zeroth-order vector field linearization.</strong></p><p>This is an <em>explicit</em> ODE solver. It is fast and scales well to high-dimensional problems [<a href="../references/#krämer21highdim">5</a>], but it is not L-stable [<a href="../references/#tronarp18probsol">4</a>]. So for stiff problems, use the <a href="#ProbNumDiffEq.EK1"><code>EK1</code></a>.</p><p>Whenever possible this solver will use a Kronecker-factored implementation to achieve its linear scaling and to get the best runtimes. This can currently be done only with an <code>IWP</code> prior (default), with a scalar diffusion model (either <code>DynamicDiffusion</code> or <code>FixedDiffusion</code>). <em>For other configurations the solver falls back to a dense implementation which scales cubically with the problem size.</em></p><p><strong>Arguments</strong></p><ul><li><code>order::Integer</code>: Order of the integrated Wiener process (IWP) prior.</li><li><code>smooth::Bool</code>: Turn smoothing on/off; smoothing is required for dense output.</li><li><code>prior::AbstractGaussMarkovProcess</code>: Prior to be used by the ODE filter.  By default, uses a 3-times integrated Wiener process prior <code>IWP(3)</code>.  See also: <a href="../priors/#Priors">Priors</a>.</li><li><code>diffusionmodel::ProbNumDiffEq.AbstractDiffusion</code>: See <a href="../diffusions/#Diffusion-models-and-calibration">Diffusion models and calibration</a>.</li><li><code>initialization::ProbNumDiffEq.InitializationScheme</code>: See <a href="../initialization/#Initialization">Initialization</a>.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; solve(prob, EK0())</code></pre><p><strong><a href="../references/#references">References</a></strong></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nathanaelbosch/ProbNumDiffEq.jl/blob/2ab532b621e01503070b9b92aebcb58b9851d7fd/src/algorithms.jl#L81-L115">source</a></section></article><h3 id="Probabilistic-Exponential-Integrators"><a class="docs-heading-anchor" href="#Probabilistic-Exponential-Integrators">Probabilistic Exponential Integrators</a><a id="Probabilistic-Exponential-Integrators-1"></a><a class="docs-heading-anchor-permalink" href="#Probabilistic-Exponential-Integrators" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProbNumDiffEq.ExpEK" href="#ProbNumDiffEq.ExpEK"><code>ProbNumDiffEq.ExpEK</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ExpEK(; L, order=3, kwargs...)</code></pre><p><strong>Probabilistic exponential integrator</strong></p><p>Probabilistic exponential integrators are a class of integrators for semi-linear stiff ODEs that provide improved stability by essentially solving the linear part of the ODE exactly. In probabilistic numerics, this amounts to including the linear part into the prior model of the solver.</p><p><code>ExpEK</code> is therefore just a short-hand for <a href="#ProbNumDiffEq.EK0"><code>EK0</code></a> with <a href="../priors/#ProbNumDiffEq.IOUP"><code>IOUP</code></a> prior:</p><pre><code class="language-julia hljs">ExpEK(; order=3, L, kwargs...) = EK0(; prior=IOUP(order, L), kwargs...)</code></pre><p>See also <a href="#ProbNumDiffEq.RosenbrockExpEK"><code>RosenbrockExpEK</code></a>, <a href="#ProbNumDiffEq.EK0"><code>EK0</code></a>, <a href="#ProbNumDiffEq.EK1"><code>EK1</code></a>.</p><p><strong>Arguments</strong></p><p>See <a href="#ProbNumDiffEq.EK0"><code>EK0</code></a> for available keyword arguments.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; prob = ODEProblem((du, u, p, t) -&gt; (@. du = - u + sin(u)), [1.0], (0.0, 10.0))
julia&gt; solve(prob, ExpEK(L=-1))</code></pre><p><strong>Reference</strong></p><ul><li>[<a href="../references/#bosch23expint">2</a>] Bosch et al, &quot;Probabilistic Exponential Integrators&quot;, arXiv (2021)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nathanaelbosch/ProbNumDiffEq.jl/blob/2ab532b621e01503070b9b92aebcb58b9851d7fd/src/algorithms.jl#L270-L299">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProbNumDiffEq.RosenbrockExpEK" href="#ProbNumDiffEq.RosenbrockExpEK"><code>ProbNumDiffEq.RosenbrockExpEK</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">RosenbrockExpEK(; order=3, kwargs...)</code></pre><p><strong>Probabilistic Rosenbrock-type exponential integrator</strong></p><p>A probabilistic exponential integrator similar to <a href="#ProbNumDiffEq.ExpEK"><code>ExpEK</code></a>, but with automatic linearization along the mean numerical solution. This brings the advantage that the linearity does not need to be specified manually, and the more accurate local linearization can sometimes also improve stability; but since the &quot;prior&quot; is adjusted at each step the probabilistic interpretation becomes more complicated.</p><p><code>RosenbrockExpEK</code> is just a short-hand for <a href="#ProbNumDiffEq.EK1"><code>EK1</code></a> with locally-updated <a href="../priors/#ProbNumDiffEq.IOUP"><code>IOUP</code></a> prior:</p><pre><code class="language-julia hljs">RosenbrockExpEK(; order=3, kwargs...) = EK1(; prior=IOUP(order, update_rate_parameter=true), kwargs...)</code></pre><p>See also <a href="#ProbNumDiffEq.ExpEK"><code>ExpEK</code></a>, <a href="#ProbNumDiffEq.EK0"><code>EK0</code></a>, <a href="#ProbNumDiffEq.EK1"><code>EK1</code></a>.</p><p><strong>Arguments</strong></p><p>See <a href="#ProbNumDiffEq.EK1"><code>EK1</code></a> for available keyword arguments.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; prob = ODEProblem((du, u, p, t) -&gt; (@. du = - u + sin(u)), [1.0], (0.0, 10.0))
julia&gt; solve(prob, RosenbrockExpEK())</code></pre><p><strong>Reference</strong></p><ul><li>[<a href="../references/#bosch23expint">2</a>] Bosch et al, &quot;Probabilistic Exponential Integrators&quot;, NeurIPS (2023)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nathanaelbosch/ProbNumDiffEq.jl/blob/2ab532b621e01503070b9b92aebcb58b9851d7fd/src/algorithms.jl#L302-L332">source</a></section></article><h2 id="solversrefs"><a class="docs-heading-anchor" href="#solversrefs">References</a><a id="solversrefs-1"></a><a class="docs-heading-anchor-permalink" href="#solversrefs" title="Permalink"></a></h2><div class="citation noncanonical"><dl><dt>[4]</dt><dd><div>F. Tronarp, H. Kersting, S. Särkkä and P. Hennig. <a href="https://doi.org/10.1007/s11222-019-09900-1"><em>Probabilistic solutions to ordinary differential equations as                   nonlinear Bayesian filtering: a new perspective</em></a>. <a href="https://doi.org/10.1007/s11222-019-09900-1">Statistics and Computing <strong>29</strong>, 1297–1315</a> (2019).</div></dd><dt>[5]</dt><dd><div>N. Krämer, N. Bosch, J. Schmidt and P. Hennig. <a href="https://proceedings.mlr.press/v162/kramer22b.html"><em>Probabilistic ODE Solutions in Millions of Dimensions</em></a>. In: <em>Proceedings of the 39th International Conference on Machine                   Learning</em>, Vol. 162 of <em>Proceedings of Machine Learning Research</em>, edited by K. Chaudhuri, S. Jegelka, L. Song, C. Szepesvari, G. Niu and S. Sabato (PMLR, 17–23 Jul 2022); pp. 11634–11649.</div></dd><dt>[2]</dt><dd><div>N. Bosch, P. Hennig and F. Tronarp. <a href="https://openreview.net/forum?id=2dx5MNs2Ip"><em>Probabilistic Exponential Integrators</em></a>. In: <em>Thirty-seventh Conference on Neural Information Processing                   Systems</em> (2023).</div></dd></dl></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorials/ode_parameter_inference/">« Parameter Inference</a><a class="docs-footer-nextpage" href="../priors/">Priors »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Monday 26 February 2024 08:54">Monday 26 February 2024</span>. Using Julia version 1.10.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
